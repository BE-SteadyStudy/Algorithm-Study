### 문제 링크
[저자별 카테고리별 매출액 집계하기](https://school.programmers.co.kr/learn/courses/30/lessons/144856)

### 풀이 방법
- 2022년 1월에 판매된 도서별 총 매출액을 구하는 공통 테이블 `BOOK_TOTAL_SALES`를 만든다.
- `BOOK`, `AUTHOR`, `BOOK_TOTAL_SALES`를 조인한다.
- 저자와 카테고리에 대해 그룹화한다.
- 저자 아이디, 저자 이름, 저자별 카테고리별 매출액을 구한다.

### 소스 코드
```sql
WITH BOOK_TOTAL_SALES AS (
    SELECT BOOK.BOOK_ID, SUM(SALES * PRICE) AS SALES
    FROM BOOK_SALES
    JOIN BOOK
    ON BOOK_SALES.BOOK_ID = BOOK.BOOK_ID
    WHERE SALES_DATE BETWEEN '2022-01-01' AND '2022-01-31'
    GROUP BY BOOK.BOOK_ID
)

SELECT BOOK.AUTHOR_ID, AUTHOR_NAME, CATEGORY, SUM(BOOK_TOTAL_SALES.SALES) AS TOTAL_SALES
FROM BOOK
JOIN AUTHOR
ON BOOK.AUTHOR_ID = AUTHOR.AUTHOR_ID
JOIN BOOK_TOTAL_SALES
ON BOOK.BOOK_ID = BOOK_TOTAL_SALES.BOOK_ID
GROUP BY AUTHOR_ID, CATEGORY
ORDER BY AUTHOR_ID, CATEGORY DESC
```