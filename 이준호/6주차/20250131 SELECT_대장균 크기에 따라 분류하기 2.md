## 문제 링크

Link : [대장균 크기에 따라 분류하기 2](https://school.programmers.co.kr/learn/courses/30/lessons/301649)

## 문제

대장균 개체의 크기를 내름차순으로 정렬했을 때 상위 0% ~ 25% 를 'CRITICAL', 26% ~ 50% 를 'HIGH', </br>
51% ~ 75% 를 'MEDIUM', 76% ~ 100% 를 'LOW' 라고 분류합니다. 대장균 개체의 ID(ID) 와 분류된 이름(COLONY_NAME)을 출력하는 SQL 문을 작성해주세요. </br>
이때 결과는 개체의 ID 에 대해 오름차순 정렬해주세요. </br>
단, 총 데이터의 수는 4의 배수이며 같은 사이즈의 대장균 개체가 서로 다른 이름으로 분류되는 경우는 없습니다.

## 문제 풀이

1. PERCENT_RANK 를 활용하여 대장균의 크기 순위를 값의 상대적 위치를 0에서 1 사이 비율로 반환합니다.
2. 반환된 칼럼들에서 CASE 를 거쳐 각 조건에 맞는 CRITICAL, HIGH, MEDIUM 으로 각각 나뉘어 결과를 반환합니다.
3. 반환된 결과를 ID를 기준으로 정렬합니다.

## SQL 코드

```sql
SELECT
    ID,
    (CASE 
        WHEN PER_RANK <= 0.25 THEN 'CRITICAL'
        WHEN PER_RANK <= 0.5 THEN 'HIGH'
        WHEN PER_RANK <= 0.75 THEN 'MEDIUM'
        ELSE 'LOW'
      END) AS COLONY_NAME
FROM (SELECT 
        ID,
        PERCENT_RANK() OVER (ORDER BY SIZE_OF_COLONY DESC) AS PER_RANK
      FROM ECOLI_DATA
     ) AS D
ORDER BY ID;
```